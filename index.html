<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฌุฏูู ุงูุฅุณุนุงู - ูุฒุงุฑุฉ ุงูุตุญุฉ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
        }

        .rating i {
            cursor: pointer;
            font-size: 1.8rem;
            color: #ccc;
            transition: transform 0.2s, color 0.2s;
        }
        .rating i.active {
            color: gold;
        }
        .rating i:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <!-- Header -->
        <div class="header-section">
            <div class="logo-container">
                <div class="logo-shine"></div>
                <img src="logo.png" alt="ุดุนุงุฑ ูุฒุงุฑุฉ ุงูุตุญุฉ" class="ministry-logo">
            </div>
            <div class="title-container">
                <h1>
                    <span class="title-highlight">ุฌุฏูู ุงูุฅุณุนุงู</span>
                    <br>
                    <span class="ministry-name">ูุฒุงุฑุฉ ุงูุตุญุฉ</span>
                </h1>
            </div>
            <div class="admin-controls">
                <div class="ms-auto">
                    <span class="me-3"><span id="employeeName"></span></span>
                    <a href="employee-login.html" class="btn btn-outline-danger" onclick="sessionStorage.removeItem('employeeData')">
                        <i class="fas fa-sign-out-alt"></i> ุชุณุฌูู ุงูุฎุฑูุฌ
                    </a>
                    <a href="protocols.html" target="_blank" class="btn btn-info-1">
                        <i class="fas fa-book"></i> ุจุฑูุชููููุงุช ุงูุฅุณุนุงู
                    </a>
                    <a href="localStorage.html" target="_blank" class="btn btn-info-2">
                        <i class="fas fa-clock"></i> ุณุฌู ุชูุงุฌุฏ ุงููุณุนููู
                    </a>
                </div>
            </div>
        </div>

        <!-- ูุนุฑุถ ุงูุตูุฑ -->
        <div class="image-gallery">
            <div class="gallery-header">
                <h3>ุตูุฑ ุงููุฑูู</h3>
            </div>
            <div class="image-grid">
                <div class="image-card">
                    <img src="teem.png" alt="ูุฑูู ุงูุฅุณุนุงู">
                    <div class="image-overlay">
                        <span class="image-title">ูุฑูู ุงูุฅุณุนุงู</span>
                    </div>
                </div>
                <div class="image-card">
                    <img src="teem2.png" alt="ุฅุฏุงุฑุฉ ุฎุฏูุงุฉ ุงูุฅุณุนุงู">
                    <div class="image-overlay">
                        <span class="image-title">ุฅุฏุงุฑุฉ ุฎุฏูุงุฉ ุงูุฅุณุนุงู</span>
                    </div>
                </div>
            </div>
            <div class="gallery-navigation"></div>
        </div>

        <!-- ุฃุฒุฑุงุฑ ุงูุชุตุฏูุฑ -->
        <div class="row mb-3">
            <div class="col">
                <button class="btn btn-success" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i> ุชุตุฏูุฑ ุฅูู Excel
                </button>
                <button class="btn btn-danger" onclick="exportToPDF()">
                    <i class="fas fa-file-pdf"></i> ุชุตุฏูุฑ ุฅูู PDF
                </button>
            </div>
        </div>

        <!-- ุฌุฏูู ุงูููุงูุจุงุช -->
        <div class="title-container">
            <h1><span class="ministry-name">ุฌุฏูู ุงูููุงูุจุงุช</span></h1>
        </div>
        <div class="table-responsive mb-5">
            <table class="table table-bordered table-hover" id="scheduleTable">
                <thead class="table-dark">
                    <tr>
                        <th>ุงูุชุงุฑูุฎ</th>
                        <th>ุงูููู</th>
                        <th>ุงููุฑุฏูุฉ</th>
                        <th>ุงูุญุงูุฉ</th>
                        <th>ุงูุชูุนูู</th>
                    </tr>
                </thead>
                <tbody id="scheduleTableBody"></tbody>
                <tr>
                    <td><i class="fas fa-check-circle text-center"></i> ูู ูุชู ุงูุชูุนูู</td>
                    <td><i class="fas fa-check-circle text-center"></i> ูู ูุชู ุงูุชูุนูู</td>
                    <td><i class="fas fa-check-circle text-center"></i> ูู ูุชู ุงูุชูุนูู</td>
                    <td><i class="fas fa-check-circle text-danger"></i> ูุฑูุจุง</td>
                    <td><i class="fas fa-check-circle text-success"></i> ุบูุฑ ููุนู</td>
                </tr>
            </table>
        </div>

        <!-- ุฌุฏูู ุจูุงูุงุช ุงููุณุนููู -->
        <div class="title-container">
            <h1><span class="ministry-name">ุจูุงูุงุช ุงููุณุนููู</span></h1>
        </div>

        <div class="table-responsive mb-5">
            <table class="table table-striped table-hover align-middle" id="paramedicTable">
                <thead class="table-dark">
                    <tr>
                        <th>ุงุณู ุงููุณุนู</th>
                        <th>ููุฏ ุงููุณุนู</th>
                        <th>ุงูุนูุฑ</th>
                        <th>ููุช ุงูุฏุฎูู</th>
                        <th>ููุช ุงูุฎุฑูุฌ</th>
                        <th>ุฅุฌูุงูู ุงูุณุงุนุงุช</th>
                        <th>ุชุญุฐูุฑ</th>
                    </tr>
                </thead>
                <tbody id="paramedicTableBody">
                    <tr>
                        <td>ูุญูุฏ</td>
                        <td>H-60</td>
                        <td>+18</td>
                        <td id="in-H-60"><button class="btn btn-success btn-sm" onclick="recordCheckIn('H-60')">ุชุณุฌูู ุงูุฏุฎูู</button></td>
                        <td id="out-H-60"><button class="btn btn-danger btn-sm" onclick="recordCheckOut('H-60')">ุชุณุฌูู ุงูุฎุฑูุฌ</button></td>
                        <td id="hours-H-60">-</td>
                        <td><i class="fas fa-check-circle text-success"></i> ูุง ููุฌุฏ</td>
                    </tr>
                    <tr>
                        <td>ุงุญูุฏ</td>
                        <td>H-8</td>
                        <td>+18</td>
                        <td id="in-H-8"><button class="btn btn-success btn-sm" onclick="recordCheckIn('H-8')">ุชุณุฌูู ุงูุฏุฎูู</button></td>
                        <td id="out-H-8"><button class="btn btn-danger btn-sm" onclick="recordCheckOut('H-8')">ุชุณุฌูู ุงูุฎุฑูุฌ</button></td>
                        <td id="hours-H-8">-</td>
                        <td><i class="fas fa-exclamation-triangle text-danger"></i> ุชุฃุฎุฑ ูู ุชุณุฌูู ุงูุฎุฑูุฌ</td>
                    </tr>
                    <tr>
                        <td>ุงูู</td>
                        <td>H-23</td>
                        <td>+18</td>
                        <td id="in-H-23"><button class="btn btn-success btn-sm" onclick="recordCheckIn('H-23')">ุชุณุฌูู ุงูุฏุฎูู</button></td>
                        <td id="out-H-23"><button class="btn btn-danger btn-sm" onclick="recordCheckOut('H-23')">ุชุณุฌูู ุงูุฎุฑูุฌ</button></td>
                        <td id="hours-H-23">-</td>
                        <td><i class="fas fa-check-circle text-success"></i> ูุง ููุฌุฏ</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ูุณู ุงูุชูููู -->
        <div class="title-container">
            <h1><span class="ministry-name">ุชูููู ูููุณุนููู ูุฑูุจุง๐ฅ</span></h1>
        </div>
        <div class="rating-section mb-5">
            <div id="paramedicRatings" class="row gy-3"></div>
        </div>
        
    </div>

    <!-- ุชุฑููู ุงูุตูุญุงุช -->
    <nav class="mt-3">
        <ul class="pagination justify-content-center" id="pagination"></ul>
    </nav>

    <!-- ุณูุฑูุจุชุงุช -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
    <script src="database.js" type="module"></script>
    <script src="employee-schedule.js"></script>

    <!-- ููุฏ ุชุณุฌูู ุงูุฏุฎูู ูุงูุฎุฑูุฌ ูุญูุธ ุงูููุช -->
    <script>
    function formatTime(date) {
        return date.toLocaleTimeString();
    }

    function calculateDuration(start, end) {
        const diffMs = end - start;
        const diffHrs = diffMs / (1000 * 60 * 60);
        return diffHrs.toFixed(2);
    }

    function recordCheckIn(paramedicId) {
        const now = new Date();
        const formatted = formatTime(now);

        // ุนุฑุถ ุงูููุช ูู ุงูุฌุฏูู
        const inCell = document.getElementById("in-" + paramedicId);
        inCell.textContent = formatted;

        // ุญูุธ ููุช ุงูุฏุฎูู
        localStorage.setItem(paramedicId + "_login", now.toISOString());

        // ุนุฑุถ ุฒุฑ ุงูุฎุฑูุฌ
        const outCell = document.getElementById("out-" + paramedicId);
        outCell.innerHTML = '<button class="btn btn-danger btn-sm" onclick="recordCheckOut(\'' + paramedicId + '\')">ุชุณุฌูู ุงูุฎุฑูุฌ</button>';
    }

    function recordCheckOut(paramedicId) {
        const now = new Date();
        const formatted = formatTime(now);

        const outCell = document.getElementById("out-" + paramedicId);
        outCell.textContent = formatted;

        localStorage.setItem(paramedicId + "_logout", now.toISOString());

        // ุญุณุงุจ ูุฏุฉ ุงูุนูู
        const loginTimeISO = localStorage.getItem(paramedicId + "_login");
        if (loginTimeISO) {
            const loginDate = new Date(loginTimeISO);
            const duration = calculateDuration(loginDate, now);

            const hoursCell = document.getElementById("hours-" + paramedicId);
            hoursCell.textContent = duration;

            localStorage.setItem(paramedicId + "_hours", duration);
        }

        // ุจุนุฏ ุชุณุฌูู ุงูุฎุฑูุฌุ ุนุฑุถ ุฒุฑ ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู
        const inCell = document.getElementById("in-" + paramedicId);
        inCell.innerHTML = '<button class="btn btn-success btn-sm" onclick="recordCheckIn(\'' + paramedicId + '\')">ุชุณุฌูู ุงูุฏุฎูู</button>';
    }

    window.addEventListener("DOMContentLoaded", () => {
        const paramedics = ["H-60", "H-8", "H-23"];
        paramedics.forEach(id => {
            const loginISO = localStorage.getItem(id + "_login");
            const logoutISO = localStorage.getItem(id + "_logout");
            const hours = localStorage.getItem(id + "_hours");

            const inCell = document.getElementById("in-" + id);
            const outCell = document.getElementById("out-" + id);
            const hoursCell = document.getElementById("hours-" + id);

            if (loginISO && (!logoutISO || new Date(loginISO) > new Date(logoutISO))) {
                // ุชุณุฌูู ุฏุฎูู ูุดุท
                inCell.textContent = formatTime(new Date(loginISO));
                outCell.innerHTML = '<button class="btn btn-danger btn-sm" onclick="recordCheckOut(\'' + id + '\')">ุชุณุฌูู ุงูุฎุฑูุฌ</button>';
            } else {
                // ุงูุชุฑุงุถูุ ุนุฑุถ ุฒุฑ ุชุณุฌูู ุงูุฏุฎูู
                inCell.innerHTML = '<button class="btn btn-success btn-sm" onclick="recordCheckIn(\'' + id + '\')">ุชุณุฌูู ุงูุฏุฎูู</button>';
                if (logoutISO) {
                    outCell.textContent = formatTime(new Date(logoutISO));
                }
            }

            if (hours) {
                hoursCell.textContent = hours;
            }
        });
    });
    </script>
</body>
        <footer>
            &copy;  2026 ูุฒุงุฑุฉ ุงูุตุญุฉ - ุฌููุน ุงูุญููู ูุญููุธุฉ ๐ฉโโ๏ธ๐๐ฑ๐ช๐๐๐ช๐ท๐
        </footer>
    </div>
</html>
